<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø­Ø¶ÙˆØ± Ø§Ù„ÙˆØ¬Ù‡ â€” ØªØ¬Ø±Ø¨Ø©</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#0f1724; /* dark */
    --bg2:#1f2937;
    --card:#f8fafc; /* soft white */
    --accent:#0b7285;
    --muted:#94a3b8;
    --glass: rgba(255,255,255,0.06);
  }
  html,body{height:100%;margin:0;font-family:'Cairo',sans-serif;background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:#eef2f7; -webkit-font-smoothing:antialiased;}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px;}
  .card{
    width:760px;
    max-width:96vw;
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
    color:#0b1320;
    border-radius:18px;
    padding:18px;
    box-shadow: 0 10px 40px rgba(2,6,23,0.6);
    display:flex;
    gap:16px;
    align-items:stretch;
    overflow:hidden;
  }

  /* left: camera */
  .cam-side{
    flex:1.15;
    display:flex;
    flex-direction:column;
    gap:12px;
    align-items:center;
    padding:14px;
  }
  .brand{
    width:100%;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
  }
  .logo{
    display:flex;align-items:center;gap:10px;
  }
  .logo .dot{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#1c7a8a);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;box-shadow:0 6px 18px rgba(11,114,133,0.28);}
  .title{font-weight:700;font-size:1.05rem;}
  .subtitle{color:var(--muted);font-size:0.85rem;}

  .video-wrap{
    width:100%;
    background:linear-gradient(180deg,#111827, #0b1220);
    border-radius:12px;
    padding:8px;
    display:flex;
    justify-content:center;
    align-items:center;
    position:relative;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
  }
  video#video{
    border-radius:10px; width:100%; max-width:420px; height:280px; object-fit:cover; background:#000;
  }
  .frame{
    position:absolute; border-radius:12px; pointer-events:none;
    width:80%; height:70%;
    box-shadow: 0 0 0 4px rgba(255,255,255,0.03) inset, 0 6px 30px rgba(12,18,24,0.35);
    border: 2px solid rgba(255,255,255,0.04);
  }

  .controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:6px;}
  button.btn{
    background:linear-gradient(180deg,#0b1220,#111827);
    color:#fff;border:none;padding:10px 16px;border-radius:10px;font-weight:700;cursor:pointer;
    box-shadow: 0 6px 18px rgba(2,6,23,0.45), 0 1px 0 rgba(255,255,255,0.02);
    transition:transform .12s ease,box-shadow .12s;
  }
  button.btn:hover{transform:translateY(-3px);box-shadow: 0 10px 30px rgba(2,6,23,0.5);}
  button.primary{background:linear-gradient(180deg,#111827,#0b1220); color:#fff;}
  button.ghost{background:transparent;border:1px solid rgba(11,17,22,0.06); color:#0b1220; font-weight:600;}
  .small{padding:8px 10px;font-size:0.95rem;border-radius:9px}

  /* right: info */
  .info-side{flex:0.9;background:linear-gradient(180deg, rgba(11,17,22,0.03), rgba(11,17,22,0.01));border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:12px;justify-content:space-between;}
  .status-box{display:flex;flex-direction:column;gap:8px;}
  .status-row{display:flex;gap:10px;align-items:center;justify-content:space-between;}
  .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;font-weight:700;box-shadow:0 6px 18px rgba(3,7,18,0.08);}
  .badge.gray{background:linear-gradient(180deg,#f1f5f9,#f8fafc);color:#0b1220;}
  .indicator{width:14px;height:14px;border-radius:50%;}
  .indicator.green{background:linear-gradient(180deg,#21bf73,#20a86b);box-shadow:0 6px 16px rgba(32,168,107,0.18);}
  .indicator.red{background:linear-gradient(180deg,#ff6b6b,#ff8a8a);box-shadow:0 6px 16px rgba(255,107,107,0.12);}

  .meter{font-weight:800;font-size:1.3rem;color:#0b6b78;}
  .msg{color:var(--muted);font-size:0.95rem}

  .result{
    display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(255,255,255,0.85));box-shadow:0 6px 18px rgba(2,6,23,0.06);
  }
  .result.success{border-left:6px solid #20bf6b;}
  .result.fail{border-left:6px solid #e84118;}

  ul.att-list{list-style:none;padding:0;margin:0;max-height:220px;overflow:auto}
  ul.att-list li{padding:8px 6px;border-bottom:1px dashed #eef2f7;color:#0b1220;font-weight:600}

  .foot{display:flex;justify-content:space-between;align-items:center;gap:10px;}
  .hint{color:var(--muted);font-size:0.9rem}

  @media (max-width:880px){
    .card{flex-direction:column;padding:12px;}
    video#video{height:220px;}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="card" role="main" aria-label="Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„ÙˆØ¬Ù‡">
    <div class="cam-side">
      <div class="brand">
        <div class="logo">
          <div class="dot">ÙˆØ¬Ù‡</div>
          <div>
            <div class="title">Ù†Ø¸Ø§Ù… Ø­Ø¶ÙˆØ± Ø§Ù„ÙˆØ¬Ù‡</div>
            <div class="subtitle">ØªØ¬Ø±Ø¨Ø© Ø³Ø±ÙŠØ¹Ø© â€” Ù…Ø¤Ù‚Øª</div>
          </div>
        </div>
        <div class="subtitle">Ø§Ù„Ù…Ø§Ùƒ â€¢ ØªØ¬Ø±Ø¨Ø© Ù…Ø­Ù„ÙŠØ©</div>
      </div>

      <div class="video-wrap">
        <video id="video" autoplay playsinline></video>
        <div class="frame" aria-hidden="true"></div>
      </div>

    <div class="controls" aria-label="Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…">
      <button id="startCam" class="btn primary small">ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
      <button id="stopCam" class="btn small">Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
      <button id="enrollBtn" class="btn ghost small">ØªØ³Ø¬ÙŠÙ„ ÙˆØ¬Ù‡ (ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª)</button>
      <button id="verifyBtn" class="btn small">ÙŠØ§ Ø­Ù„Ùˆ Ø§Ø¶ØºØ· Ù‡Ù†Ø§ ğŸ˜‚</button>
      <button id="clearEnroll" class="btn small">Ø­Ø°Ù Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</button>
      <button class="btn small" onclick="window.history.back()">Ø¹ÙˆØ¯Ø©</button>
    </div>

      <canvas id="hiddenCanvas" width="320" height="240" style="display:none"></canvas>
    </div>

    <aside class="info-side" aria-label="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª">
      <div class="status-box">
        <div class="status-row">
          <div class="badge gray"><span class="indicator green" id="camIndicator"></span> Ø§Ù„Ø­Ø§Ù„Ø©</div>
          <div class="msg" id="camMsg">Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…ØªÙˆÙ‚ÙØ©</div>
        </div>

        <div class="status-row">
          <div style="display:flex;flex-direction:column;">
            <div class="hint">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ·Ø§Ø¨Ù‚</div>
            <div class="meter" id="matchMeter">â€” %</div>
          </div>
          <div style="width:1px;background:rgba(11,17,22,0.04);height:80px"></div>
          <div style="flex:1;">
            <div class="hint">Ø¢Ø®Ø± Ù†ØªÙŠØ¬Ø©</div>
            <div id="lastResult" class="msg">Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ø¹Ø¯</div>
          </div>
        </div>
      </div>

      <div>
        <div style="margin-bottom:8px;font-weight:700">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± (Ù…Ø­Ù„ÙŠ)</div>
        <ul class="att-list" id="attendanceList">
          <!-- items -->
        </ul>
      </div>

      <div class="foot">
        <div class="hint">Ø¬Ø±Ø¨ ØªØ³Ø¬ÙŠÙ„ ÙˆØ¬Ù‡Ùƒ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… ØªØ­Ù‚Ù‚!</div>
        <div style="display:flex;gap:8px">
          <button id="exportBtn" class="btn small">ØªØµØ¯ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ±</button>
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
/*
  Ø´Ø±Ø­ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø·Ø±ÙŠÙ‚Ø©:
  - Ù†Ø³ØªØ®Ø¯Ù… getUserMedia Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
  - Ø¹Ù†Ø¯ "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆØ¬Ù‡" Ù†Ø£Ø®Ø° Ù„Ù‚Ø·Ø© ÙˆÙ†Ø®Ø²Ù‘Ù† Ù†Ø³Ø®Ø© Ù…ØµØºÙ‘Ø±Ø© (64x64) ÙÙŠ localStorage ÙƒÙ€ base64
  - Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ù†Ø§Ø®Ø° Ù„Ù‚Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙˆÙ†ÙØµØºÙ‘Ø±Ù‡Ø§ ÙˆÙ†Ù‚Ø§Ø±Ù† Ø¨ÙƒØ³Ù„-Ù„Ø¨ÙƒØ³Ù„ (Ù…ØªÙˆØ³Ø· Ø§Ù„ÙØ±Ù‚)
  - Ù†Ø­Ø³Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ´Ø§Ø¨Ù‡: similarity = 100 - (MAD/255*100)
  - Ø¥Ø°Ø§ ÙÙˆÙ‚ threshold => Ù†Ø¬Ø§Ø­ => ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±
  Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø·Ø±ÙŠÙ‚Ø© "Ù…Ø¤Ù‚ØªØ©/Ø®ÙÙŠÙØ©" ÙˆÙ„ÙŠØ³Øª Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© (face embeddings).
*/

const video = document.getElementById('video');
const startCam = document.getElementById('startCam');
const stopCam = document.getElementById('stopCam');
const enrollBtn = document.getElementById('enrollBtn');
const verifyBtn = document.getElementById('verifyBtn');
const clearEnroll = document.getElementById('clearEnroll');
const camIndicator = document.getElementById('camIndicator');
const camMsg = document.getElementById('camMsg');
const matchMeter = document.getElementById('matchMeter');
const lastResult = document.getElementById('lastResult');
const attendanceList = document.getElementById('attendanceList');
const exportBtn = document.getElementById('exportBtn');

const canvas = document.getElementById('hiddenCanvas');
const ctx = canvas.getContext('2d');

let stream = null;
let isCameraOn = false;
const THRESHOLD = 95; // Ù†Ø³Ø¨Ø© Ù‚Ø¨ÙˆÙ„ (ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§)

function setCamState(on){
  isCameraOn = !!on;
  camIndicator.classList.toggle('green', on);
  camIndicator.classList.toggle('red', !on);
  camMsg.textContent = on ? 'Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªØ¹Ù…Ù„' : 'Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…ØªÙˆÙ‚ÙØ©';
}

async function startCamera(){
  try{
    stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio:false });
    video.srcObject = stream;
    setCamState(true);
  }catch(err){
    console.error('camera err', err);
    alert('ÙØ´Ù„ ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ â€” ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª.');
    setCamState(false);
  }
}

function stopCamera(){
  if(stream){
    stream.getTracks().forEach(t => t.stop());
    stream = null;
  }
  video.srcObject = null;
  setCamState(false);
}

startCam.addEventListener('click', startCamera);
stopCam.addEventListener('click', stopCamera);

function captureImage(resizeTo=64){
  // Ù†Ø±Ø³Ù… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù„Ù‰ ÙƒØ§Ù†ÙØ§Ø³ Ù…ØµØºÙ‘Ø± (Ù†Ø­ÙˆÙ„ Ø¥Ù„Ù‰ grayscale)
  const w = resizeTo, h = resizeTo;
  canvas.width = w; canvas.height = h;
  ctx.drawImage(video, 0, 0, w, h);
  // Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙŠÙƒØ³Ù„
  const imgData = ctx.getImageData(0,0,w,h);
  const data = imgData.data;
  // Ù†Ø­ÙˆÙ„ Ø§Ù„Ù‰ Ø±Ù…Ø§Ø¯ÙŠ ÙˆÙ†Ø±Ø¬Ø¹ Ù…ØµÙÙˆÙØ© Ù…Ù† Ø§Ù„Ù‚ÙŠÙ… 0-255
  const gray = new Uint8ClampedArray(w*h);
  for(let i=0, j=0; i<data.length; i+=4, j++){
    const r=data[i], g=data[i+1], b=data[i+2];
    // luminance
    const l = (0.299*r + 0.587*g + 0.114*b);
    gray[j] = Math.round(l);
  }
  return {w,h,gray,base64: canvas.toDataURL('image/png')};
}

function saveEnrolled(imgObj){
  // Ù†Ø®Ø²Ù† Ø§Ù„Ø¨Ø§ÙŠØ³64 ÙˆØ§Ù„Ù…ØµÙÙˆÙØ© ÙƒÙ€ base64 ÙÙ‚Ø· Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ â€” ÙˆÙ†Ø³Ø¬Ù„ Ø§Ù„Ù€ gray ÙƒÙ€ base64 Ø«Ø§Ù†ÙŠ
  try{
    localStorage.setItem('face_enrolled_img', imgObj.base64);
    // Ù†Ø®Ø²Ù† Ø§Ù„Ù…ØµÙÙˆÙØ© ÙƒÙ€ base64 Ù†ØµÙŠ (Ø³Ø±ÙŠØ¹)
    localStorage.setItem('face_enrolled_gray', btoa(String.fromCharCode(...imgObj.gray)));
    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙˆØ¬Ù‡ Ù…Ø¤Ù‚ØªÙ‹Ø§ (localStorage).');
    lastResult.textContent = 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ ÙˆØ¬Ù‡ ÙˆØ§Ø­Ø¯ (Ù…Ø®Ø²Ù† Ù…Ø­Ù„ÙŠ).';
  }catch(e){
    console.error(e); alert('ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸ ÙÙŠ localStorage.');
  }
}

function loadEnrolled(){
  const b64 = localStorage.getItem('face_enrolled_img');
  const grayB64 = localStorage.getItem('face_enrolled_gray');
  if(!b64 || !grayB64) return null;
  const raw = atob(grayB64);
  const arr = new Uint8ClampedArray(raw.length);
  for(let i=0;i<raw.length;i++) arr[i]=raw.charCodeAt(i);
  return { base64: b64, gray: arr, w:64, h:64 };
}

function clearEnrollment(){
  localStorage.removeItem('face_enrolled_img');
  localStorage.removeItem('face_enrolled_gray');
  lastResult.textContent = 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©.';
  matchMeter.textContent = 'â€” %';
}

function compareGray(a,b){
  // a,b Uint8ClampedArray same length
  if(!a || !b || a.length!==b.length) return 0;
  let s=0;
  for(let i=0;i<a.length;i++){
    s += Math.abs(a[i]-b[i]);
  }
  const mad = s / a.length; // mean abs diff 0..255
  const similarity = Math.max(0, 100 - (mad/255*100)); // 0..100
  return similarity;
}

function addAttendance(name,sim){
  const time = new Date();
  const hh = time.toLocaleTimeString();
  const li = document.createElement('li');
  li.textContent = `${name} â€” ${hh} â€” ${Math.round(sim)}%`;
  attendanceList.prepend(li);
  // optional: save attendance to localStorage
  const old = JSON.parse(localStorage.getItem('face_attendance') || '[]');
  old.unshift({name, time: time.toISOString(), sim: Math.round(sim)});
  localStorage.setItem('face_attendance', JSON.stringify(old.slice(0,200)));
}

function loadAttendanceList(){
  const old = JSON.parse(localStorage.getItem('face_attendance') || '[]');
  attendanceList.innerHTML = '';
  for(const it of old){
    const li = document.createElement('li');
    const t = new Date(it.time).toLocaleString();
    li.textContent = `${it.name} â€” ${t} â€” ${it.sim}%`;
    attendanceList.appendChild(li);
  }
}

enrollBtn.addEventListener('click', ()=>{
  if(!isCameraOn){ alert('Ø´ØºÙ‘Ù„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  const img = captureImage(64);
  saveEnrolled(img);
});

clearEnroll.addEventListener('click', ()=>{
  if(confirm('ØªØ£ÙƒÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©ØŸ')) clearEnrollment();
});

verifyBtn.addEventListener('click', ()=>{
  if(!isCameraOn){ alert('Ø´ØºÙ‘Ù„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  const enrolled = loadEnrolled();
  if(!enrolled){ alert('Ù…Ø§ÙÙŠ Ø¨ØµÙ…Ø© Ù…Ø­ÙÙˆØ¸Ø© â€” Ø³Ø¬Ù‘Ù„ ÙˆØ¬Ù‡ Ø£ÙˆÙ„Ø§Ù‹'); return; }

  const current = captureImage(64);
  const sim = compareGray(enrolled.gray, current.gray);
  matchMeter.textContent = Math.round(sim) + ' %';

  if(sim >= THRESHOLD){
    // Ù†Ø¬Ø­
    lastResult.textContent = 'Ù†Ø¬Ø­ Ø§Ù„ØªØ­Ù‚Ù‚ â€” ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±';
    const resultBox = document.createElement('div');
    resultBox.className = 'result success';
    resultBox.textContent = 'ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ â€” Ø­Ø¶ÙˆØ± Ù…Ø³Ø¬Ù‘Ù„';
    // Ø·Ù„Ø¨ Ø§Ø³Ù… (Ø¨Ø³ÙŠØ·)
    const name = prompt('Ø§Ø³Ù… Ø§Ù„Ø­Ø§Ø¶Ø± (Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø£Ùˆ Ø§Ø¶ØºØ· Ù…ÙˆØ§ÙÙ‚):', 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
    addAttendance(name || 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', sim);
    // Ø¹Ø±Ø¶ Ù„Ù…Ø­Ø©
  }else{
    lastResult.textContent = 'ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ â€” Ø§Ù„ÙˆØ¬Ù‡ ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚';
    const resultBox = document.createElement('div');
    resultBox.className = 'result fail';
    resultBox.textContent = 'Ø§Ù„ÙØ´Ù„ â€” Ø­Ø§ÙˆÙ„ Ù…Ø±Ù‘Ø© Ø«Ø§Ù†ÙŠØ©';
  }
});

exportBtn.addEventListener('click', ()=>{
  const data = JSON.parse(localStorage.getItem('face_attendance') || '[]');
  if(!data.length){ alert('Ù…Ø§ ÙÙŠ Ø³Ø¬Ù„Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±'); return; }
  let csv = '\uFEFFØ§Ù„Ø§Ø³Ù…,Ø§Ù„Ø²Ù…Ø§Ù†,Ø§Ù„Ù†Ø³Ø¨Ø©\n';
  for(const r of data){
    csv += `"${r.name}","${r.time}","${r.sim}"\n`;
  }
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'attendance_face.csv';
  a.click();
  URL.revokeObjectURL(a.href);
});

// load saved attendance on start
loadAttendanceList();

// UX: detect if enrolled exists and show message
if(loadEnrolled()){
  lastResult.textContent = 'Ø¨ØµÙ…Ø© Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§ â€” Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ù‚Ù‚';
}

// before unload, stop camera
window.addEventListener('beforeunload', ()=> stopCamera());

</script>
</body>
</html>
